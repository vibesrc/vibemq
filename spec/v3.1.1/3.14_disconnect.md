# 3.14 DISCONNECT – Disconnect notification

The DISCONNECT Packet is the final Control Packet sent from the Client to the Server. It indicates that the Client is disconnecting cleanly.

### 3.14.1 Fixed header

##### Figure 3.35 – DISCONNECT Packet fixed header

```mermaid
packet
  0-3: "Reserved (0000)"
  4-7: "MQTT Control Packet type (1110)"
  8-15: "Remaining Length (0x00)"
```

The Server MUST validate that reserved bits are set to zero and disconnect the Client if they are not zero \[MQTT-3.14.1-1\].

### 3.14.2 Variable header

The DISCONNECT Packet has no variable header.

### 3.14.3 Payload

The DISCONNECT Packet has no payload.

### 3.14.4 Response

After sending a DISCONNECT Packet the Client:

- MUST close the Network Connection \[MQTT-3.14.4-1\].
- MUST NOT send any more Control Packets on that Network Connection \[MQTT-3.14.4-2\].

On receipt of DISCONNECT the Server:

- MUST discard any Will Message associated with the current connection without publishing it, as described in Section 3.1.2.5 \[MQTT-3.14.4-3\].
- SHOULD close the Network Connection if the Client has not already done so.

# 4 Operational behavior

## 4.1 Storing state

It is necessary for the Client and Server to store Session state in order to provide Quality of Service guarantees. The Client and Server MUST store Session state for the entire duration of the Session \[MQTT-4.1.0-1\]. A Session MUST last at least as long it has an active Network Connection \[MQTT-4.1.0-2\].

Retained messages do not form part of the Session state in the Server. The Server SHOULD retain such messages until deleted by a Client.

**Non normative comment**

The storage capabilities of Client and Server implementations will of course have limits in terms of capacity and may be subject to administrative policies such as the maximum time that Session state is stored between Network Connections. Stored Session state can be discarded as a result of an administrator action, including an automated response to defined conditions. This has the effect of terminating the Session. These actions might be prompted by resource constraints or for other operational reasons. It is prudent to evaluate the storage capabilities of the Client and Server to ensure that they are sufficient.

**Non normative comment**

It is possible that hardware or software failures may result in loss or corruption of Session state stored by the Client or Server.

**Non normative comment**

Normal operation of the Client of Server could mean that stored state is lost or corrupted because of administrator action, hardware failure or software failure. An administrator action could be an automated response to defined conditions. These actions might be prompted by resource constraints or for other operational reasons. For example the server might determine that based on external knowledge, a message or messages can no longer be delivered to any current or future client.

**Non normative comment**

An MQTT user should evaluate the storage capabilities of the MQTT Client and Server implementations to ensure that they are sufficient for their needs.
